@startuml
title C4 Component Diagram - Extension Analysis Platform

skinparam backgroundColor White
skinparam componentStyle uml2

rectangle "Frontend Container\n(Web UI)" as frontend #LightBlue {
  component "Upload + Results UI" as ui
}

rectangle "Backend Container\n(Django API)" as backend #LightCoral {
  component "API Router\n(apiCaller())" as api
  component "ExtensionIDConverter" as converter
  component "Report Generator" as report
  component "VT Interface" as vt
  component "SecureAnnex Interface" as sa
  component "OPSWAT Interface" as opswat
  component "database parser" as db_mod
  database "SQLite DB" as db
}

rectangle "External Systems" as externals #CornflowerBlue {
  component "\nVirusTotal" as vt_ext
  component "SecureAnnex API" as sa_ext
  component "OPSWAT MetaDefender" as ops_ext
}

' Relationships (C4 semantics)
ui --> api : POST / scan request

api --> converter : derive extension ID
api --> vt : file scan
api --> sa : ID-based scan
api --> opswat : file scan
api --> report : assemble scores, risks, permissions

vt --> vt_ext : Analyze extension
sa --> sa_ext : Analyze extension
opswat --> ops_ext : Analyze extension

report --> db_mod : Convert dict to json
db_mod --> db : persist results

ui <-- db : Fetches reports


@enduml
