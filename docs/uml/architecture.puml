@startuml
title C4 Component Diagram - Extension Analysis Platform

skinparam backgroundColor White
skinparam componentStyle uml2

rectangle "Frontend Container\n(Web UI)" as frontend #LightBlue {
  component "Upload + Results UI" as ui
  component "Sign in" as sign
  component "MITRE Dashboard" as mitre
  component "History View" as history
}

rectangle "Backend Container\n(Django API)" as backend #LightCoral {
  component "API Router\n(apiCaller())" as api
  component "ExtensionIDConverter" as converter
  component "Report Generator" as report
  component "VT Interface" as vt
  component "SecureAnnex Interface" as sa
  component "OPSWAT Interface" as opswat
  component "Database Parser" as db_mod
  component "AI Module" as ai
  database "SQLite DB" as db
}

rectangle "External Systems" as externals #CornflowerBlue {
  component "VirusTotal" as vt_ext
  component "SecureAnnex API" as sa_ext
  component "OPSWAT MetaDefender" as ops_ext
}

' Frontend -> Backend
ui --> api : Submit scan request
history --> db : Fetch reports
mitre --> api : Start MITRE analysis

' Backend internal flow
api --> converter : Get extension ID
api --> vt : Request scan
api --> sa : Request scan
api --> opswat : Request scan

vt --> vt_ext : External scan & Sandboxing 
sa --> sa_ext : External scan
opswat --> ops_ext : External scan

api --> report : Aggregate results
report --> ai : Pass extracted data
ai --> db_mod : Store in DB format
db_mod --> db : Persist results

' MITRE special handling
api --> vt_ext : MITRE lookup
api --> db : Save MITRE data

@enduml
