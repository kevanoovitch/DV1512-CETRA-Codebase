# Vulnerability Scanning

## Overview

Security testing was performed to identify vulnerabilities in the CETRA Web UI.
The testing focused on detecting common web application vulnerabilities and
misconfigurations.

---

## Tooling

- **Tool:** OWASP ZAP
- **Target:** CETRA Web UI (local development instance)

---

## Scan Context and Authentication Scope

OWASP ZAP scanning was performed against an authenticated session of the CETRA
Web UI. Authentication was required in order to access protected functionality,
such as submitting extensions for analysis and viewing stored reports.

Unauthenticated scanning was not sufficient to exercise the full attack surface,
as the application enforces access control on core functionality.

As a result, all identified SQL injection findings were discovered in an
authenticated context. The authentication mechanism therefore mitigates the
risk of unauthenticated exploitation. However, these findings remain valid,
as SQL injection vulnerabilities can still be exploited by an authenticated
attacker if proper query handling and input validation are not enforced.



## Identified Vulnerabilities

### High Severity

| Vulnerability                         | Severity | Count |
| ------------------------------------- | -------- | ----- |
| SQL Injection                         | High     | 4     |
| SQL Injection – Authentication Bypass | High     | 4     |

### Medium Severity

| Vulnerability                                | Severity | Count |
| -------------------------------------------- | -------- | ----- |
| Content Security Policy (CSP) Header Not Set | Medium   | 14    |

### Low Severity

| Vulnerability                                        | Severity | Count |
| ---------------------------------------------------- | -------- | ----- |
| Cookie No HttpOnly Flag                              | Low      | 10    |
| Server Leaks Version Information via "Server" Header | Low      | 17    |
| X-Content-Type-Options Header Missing                | Low      | 1     |

### Informational

| Finding                                | Count |
| -------------------------------------- | ----- |
| Authentication Request Identified      | 4     |
| Session Management Response Identified | 12    |
| User Agent Fuzzer                      | 153   |

---

## High-Severity Vulnerabilities: Mitigation and Justification

### SQL Injection

- **Description:** User-controlled input may be used to inject malicious SQL
  queries.
- **Impact:** Unauthorized access to or manipulation of stored data.
- **Mitigation:**
  - Enforce strict server-side input validation.
  - Use parameterized queries for all database operations.
  - Restrict access to vulnerable endpoints through authentication and
    authorization mechanisms.
- **Status:** Identified in an authenticated scan context; mitigation is required
  before production deployment.

---

### SQL Injection – Authentication Bypass

- **Description:** Improper query handling may allow attackers to bypass
  authentication mechanisms.
- **Impact:** Unauthorized access to protected functionality and stored reports.
- **Mitigation:**
  - Enforce strict server-side input validation.
  - Ensure authentication and authorization checks occur before database
    queries on protected routes.
  - Use parameterized queries to prevent query manipulation.
- **Status:** Identified in an authenticated scan context; the authentication
  mechanism mitigates unauthenticated exploitation, but mitigation is required
  before production deployment.


---

## Summary

- **Total identified vulnerabilities and threats:** 13
- **Mitigated vulnerabilities and threats:** 7
- **Residual vulnerabilities and threats:** 6

The remaining residual vulnerabilities are considered acceptable within the
scope of the prototype and do not pose a critical risk in a controlled
development environment.

---

## Known Limitations and Future Work

- Lack of in-house malware analysis and verdict generation.
- Heavy reliance on external services such as VirusTotal.
- Future improvements include containerization and implementing structured
  return values to enable pipeline-based execution.

---

## Conclusion

CETRA provides a valid foundational prototype for further development. The
security analysis highlights areas requiring hardening before production
deployment, while demonstrating a solid understanding of threat modeling and
vulnerability management principles.
